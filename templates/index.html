{% extends "_layouts/cp" %}

{% from "_includes/forms" import text %}

{% set title = 'Translate'|t %}

{% if craft.isLocalized() %}
	{% set editableLocaleIds = craft.i18n.getEditableLocaleIds() %}
	{% if editableLocaleIds|length %}
		{% if craft.locale in editableLocaleIds %}
			{% set initialLocale = craft.i18n.getCurrentLocale() %}
		{% else %}
			{% set initialLocale = craft.i18n.getLocaleById(editableLocaleIds|first) %}
		{% endif %}
	{% endif %}
{% else %}
    {% exit 403 %}
{% endif %}

{% set content %}
<div class="elementindex">
	<div class="main">
		<form method="post" accept-charset="utf-8">
		    <input type="hidden" name="action" value="translate/save">
		    <input type="hidden" name="locale" value="{{ initialLocale }}">
    		<div class="elements">
        		<div class="tableview">
        			<table class="data fullwidth">
        				<thead>
        					<th scope="col" data-attribute="original" style="width: 50%;">{{ "Original"|t }}</th>
        					<th scope="col" data-attribute="translation" style="width: 50%;">{{ "Translation"|t }}</th>
        				</thead>
        				<tbody>
        				{% for original, translation in craft.translate.occurences() %}
    					    <tr>
    							<td scope="row" data-title="{{ "Original"|t }}">
    								<div class="element" data-locale="{{ initialLocale }}" data-status="{{ original == translation ? "pending" : "live" }}" data-label="{{ original|raw }}">
    								    <div class="label"><span class="status {{ original == translation ? "pending" : "live" }}"></span><span class="title">{{ original|raw }}</span></div>
    								</div>
    							</td>
    							<td data-title="{{ "Translation"|t }}">
    							    <input type="text" class="text nicetext fullwidth" name="translation[{{ original|raw|e('html_attr') }}]" value="{{ translation|raw|e('html_attr') }}">
    							</td>
    						</tr>
    					{% endfor %}
        				</tbody>
        			</table>
        		</div>
        		<div class="buttons">
        			<input type="submit" class="btn submit" value="{{ 'Save'|t }}">
        		</div>
    		</div>
		</form>
	</div>
</div>
{% endset %}