{% extends "_layouts/elementindex" %}
{% set title = "Translate"|t %}
{% set elementType = 'Translate' %}

{% block sidebar %}
    <div class="buttons">
    	<a class="btn submit menubtn">{{ "Translate"|t }}</a>
    	<div class="menu">
    		<ul>
    			<li><a href="{{ actionUrl('translate/refresh') }}">{{ "Refresh"|t }}</a></li>
    			<li><a href="{{ actionUrl('translate/download') }}">{{ "Download"|t }}</a></li>
    			<li><a href="{{ actionUrl('translate/upload') }}">{{ "Upload"|t }}</a></li>
    		</ul>
    	</div>
    </div>

	{{ parent() }}
{% endblock %}

{% block content %}
	<form method="post" accept-charset="utf-8">
    	<input type="hidden" name="action" value="translate/save">
        <input type="hidden" name="locale" value="{{ craft.locale }}">
        
		{{ parent() }}
		
		<div class="buttons hidden">
		    <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
		</div>
	</form>
{% endblock %}

{% block initJs %}
    {{ parent() }}
    
    // Get locale menu btn
    var $localeMenuBtn = $('.localemenubtn:first').menubtn().data('menubtn').menu;
    
    // Get locale form element
    var $localeFormElm = $('input[name="locale"]');
    
    // Init form with selected locale
    $localeFormElm.val(Craft.getLocalStorage('BaseElementIndex.locale'));
    
    // Change locale on select
    $localeMenuBtn.on('optionselect', function(ev) {
        $localeFormElm.val($(ev.selectedOption).data('locale'));
    });
    
{% endblock %}